import{j as e,r,m as u,L as D,$ as g}from"./app-gWrj3sI5.js";import{T as i,I as c}from"./TextInput-7rS5lJrb.js";import{I as d}from"./InputLabel-8Vq9ZSgS.js";import{P as j}from"./PrimaryButton-Bw4HywTO.js";import{G as F}from"./GuestLayout-D_Icv3uX.js";function _({className:n="",...l}){return e.jsx("input",{...l,type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500 dark:border-gray-700 dark:bg-gray-900 dark:focus:ring-indigo-600 dark:focus:ring-offset-gray-800 "+n})}function T({status:n,canResetPassword:l}){const[b,h]=r.useState(!1),[p,f]=r.useState(""),[a,v]=r.useState("email"),[N,y]=r.useState(""),t=u({email:"",password:"",remember:!1,otp_method:"email"}),o=u({email:"",otp:"",otp_method:"email",remember:!1});r.useEffect(()=>{t.setData("otp_method",a),o.setData("otp_method",a)},[a]);const k=s=>{s.preventDefault(),t.setData("otp_method",a),t.post(route("login.request-otp"),{onSuccess:m=>{h(!0),f(t.data.email),m!=null&&m.maskedPhone&&y(m.maskedPhone),o.setData({email:t.data.email,otp_method:a,remember:t.data.remember,otp:""})},preserveScroll:!0})},w=s=>{s.preventDefault(),o.setData("otp_method",a),o.post(route("login.verify-otp"),{onSuccess:()=>{},onError:()=>{}})},C=()=>{const s={email:p,otp_method:a};t.post(route("login.request-otp"),{data:s,onSuccess:()=>{},preserveScroll:!0})},x=s=>{v(s),t.setData("otp_method",s),o.setData("otp_method",s)},S=()=>{console.log("Current otpMethod state:",a),console.log("Login Form otp_method:",t.data.otp_method),console.log("OTP Form otp_method:",o.data.otp_method)};return e.jsxs(F,{children:[e.jsx(D,{title:"Log in"}),e.jsxs("div",{className:"d-flex flex-column min-vh-100 align-items-center bg-light pt-3 justify-content-center",children:[e.jsxs("a",{className:"navbar-brand cursor-pointer",href:route("home"),style:{color:"#006838",fontWeight:"600"},children:[e.jsx("img",{src:"assets/images/online.png",alt:"Logo",style:{width:"40px"}}),"Telemedicine"]}),e.jsxs("div",{className:"mt-3 w-100 bg-white p-4 shadow-sm rounded",style:{maxWidth:"400px"},children:[n&&e.jsx("div",{className:"mb-3 text-success small",children:n}),b?e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-3 text-center",children:[e.jsx("h5",{children:"Verification Code"}),e.jsx("p",{className:"small",children:a==="email"?e.jsxs(e.Fragment,{children:["We've sent a verification code to ",e.jsx("strong",{children:p})]}):e.jsxs(e.Fragment,{children:["We've sent a verification code via SMS to ",e.jsx("strong",{children:N||"your registered phone number"})]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{htmlFor:"otp",value:"Enter OTP Code"}),e.jsx(i,{id:"otp",type:"text",name:"otp",value:o.data.otp,className:"form-control",isFocused:!0,onChange:s=>o.setData("otp",s.target.value),maxLength:6}),e.jsx("input",{type:"hidden",name:"otp_method",value:a}),e.jsx(c,{message:o.errors.otp,className:"text-danger small"})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("button",{type:"button",onClick:C,className:"text-decoration-none text-primary small border-0 bg-transparent",disabled:t.processing,children:"Resend Code"}),e.jsx(j,{className:"btn btn-primary",disabled:o.processing,children:"Verify & Login"})]}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>h(!1),className:"text-decoration-none text-primary small border-0 bg-transparent",children:"Go back"})})]}):e.jsxs("form",{onSubmit:k,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"email",value:"Email"}),e.jsx(i,{id:"email",type:"email",name:"email",value:t.data.email,className:"form-control",autoComplete:"username",isFocused:!0,onChange:s=>t.setData("email",s.target.value)}),e.jsx(c,{message:t.errors.email,className:"text-danger small"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"password",value:"Password"}),e.jsx(i,{id:"password",type:"password",name:"password",value:t.data.password,className:"form-control",autoComplete:"current-password",onChange:s=>t.setData("password",s.target.value)}),e.jsx(c,{message:t.errors.password,className:"text-danger small"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"mb-2",children:"Verification Method:"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"otpMethod",id:"emailMethod",checked:a==="email",onChange:()=>x("email")}),e.jsx("label",{className:"form-check-label",htmlFor:"emailMethod",children:"Email OTP"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"otpMethod",id:"smsMethod",checked:a==="sms",onChange:()=>x("sms")}),e.jsx("label",{className:"form-check-label",htmlFor:"smsMethod",children:"SMS OTP"})]})]}),e.jsx("input",{type:"hidden",name:"otp_method",value:a})]}),e.jsxs("div",{className:"form-check mb-3",children:[e.jsx(_,{id:"remember",name:"remember",checked:t.data.remember,onChange:s=>t.setData("remember",s.target.checked),className:"form-check-input"}),e.jsx("label",{className:"form-check-label",htmlFor:"remember",children:"Remember me"})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[l&&e.jsx(g,{href:route("password.request"),className:"text-decoration-none text-primary small",children:"Forgot your password?"}),e.jsx(j,{className:"btn btn-primary",disabled:t.processing,onClick:()=>S(),children:"Continue"})]})]}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:"small",children:"Don't have an account? "}),e.jsx(g,{href:route("register"),style:{marginLeft:"3px"},className:"text-decoration-none text-primary small",children:"Sign up"})]})]})]})]})}export{T as default};
